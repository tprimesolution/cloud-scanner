(()=>{var e={};e.id=198,e.ids=[198],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},39491:e=>{"use strict";e.exports=require("assert")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},71017:e=>{"use strict";e.exports=require("path")},12781:e=>{"use strict";e.exports=require("stream")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},79626:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>x,pages:()=>d,routeModule:()=>h,tree:()=>c});var a=t(67096),r=t(16132),l=t(37284),i=t.n(l),n=t(32564),o={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);t.d(s,o);let c=["",{children:["(app)",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,48977)),"/Users/pritamkhergade/cursor/cs/frontend/app/(app)/page.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,43233)),"/Users/pritamkhergade/cursor/cs/frontend/app/(app)/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,9291,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,35345)),"/Users/pritamkhergade/cursor/cs/frontend/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,9291,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/pritamkhergade/cursor/cs/frontend/app/(app)/page.tsx"],x="/(app)/page",m={require:t,loadChunk:()=>Promise.resolve()},h=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/(app)/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},31499:(e,s,t)=>{Promise.resolve().then(t.bind(t,89363))},89363:(e,s,t)=>{"use strict";t.r(s),t.d(s,{DashboardClient:()=>DashboardClient});var a=t(30784),r=t(9885),l=t(20644),i=t(95555),n=t(20599),o=t(98699);function Skeleton({className:e,...s}){return a.jsx("div",{className:(0,o.cn)("animate-pulse rounded-md bg-muted/60",e),...s})}var c=t(24138),d=t(63647),x=t(16324),m=t(44723);function ComplianceScoreCard({score:e,loading:s,lastEvaluated:t,resourceCount:r}){let l=Math.max(0,Math.min(e,100));return(0,a.jsxs)(n.Zb,{className:"h-full bg-gradient-to-br from-slate-950 via-slate-950/80 to-slate-900/80 border-slate-800 shadow-soft",children:[(0,a.jsxs)(n.Ol,{className:"flex flex-row items-center justify-between border-b border-slate-800/80 pb-3",children:[(0,a.jsxs)(n.ll,{className:"flex items-center gap-2 text-sm text-slate-100",children:[a.jsx(c.Z,{className:"h-4 w-4 text-sky-300"}),"Overall Compliance"]}),a.jsx("span",{className:(0,o.cn)("text-[11px] font-medium",l>=90?"text-emerald-400":l>=75?"text-sky-300":"text-amber-300"),children:l>=90?"Excellent":l>=75?"Healthy":"At risk"})]}),a.jsx(n.aY,{className:"flex items-center gap-4 pt-5",children:s?(0,a.jsxs)("div",{className:"flex flex-1 items-center gap-4",children:[a.jsx(Skeleton,{className:"h-24 w-24 rounded-full"}),(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx(Skeleton,{className:"h-5 w-16"}),a.jsx(Skeleton,{className:"h-3 w-24"}),a.jsx(Skeleton,{className:"h-3 w-32"})]})]}):(0,a.jsxs)(a.Fragment,{children:[a.jsx("div",{className:"h-28 w-28",children:a.jsx(d.h,{children:a.jsx(x.u,{children:a.jsx(m.b,{data:[{name:"Compliant",value:l},{name:"Gap",value:100-l}],dataKey:"value",innerRadius:34,outerRadius:54,startAngle:90,endAngle:-270,stroke:"none",cornerRadius:8})})})}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{className:"text-3xl font-semibold text-slate-50",children:[l.toFixed(0),"%"]}),a.jsx("p",{className:"text-xs text-slate-400",children:"Benchmarked against CIS AWS, ISO 27001, and SOC 2 controls."}),(0,a.jsxs)("p",{className:"text-[11px] text-slate-500",children:["Last evaluated"," ",a.jsx("span",{className:"text-slate-300",children:t?new Date(t).toLocaleString():"Never"})," ","across"," ",(0,a.jsxs)("span",{className:"text-slate-300",children:[r??0," resources"]}),"."]})]})]})})]})}var h=t(70173),u=t(94163),p=t(44901),f=t(27157);let b={neutral:"bg-slate-900/80 border-slate-800/80",risk:"bg-amber-950/60 border-amber-500/20",positive:"bg-emerald-950/40 border-emerald-500/25"};function SummaryMetrics({metrics:e,loading:s}){let t=[{label:"Total Assets",value:s?"—":String(e?.totalAssets??0),delta:void 0,icon:h.Z,tone:"neutral"},{label:"Active Violations",value:s?"—":String(e?.activeViolations??0),delta:void 0,icon:u.Z,tone:"risk"},{label:"Critical Risks",value:s?"—":String(e?.criticalRisks??0),delta:void 0,icon:p.Z,tone:"risk"},{label:"Framework Coverage",value:s?"—":e?.frameworkCoverage??"0%",delta:"CIS, ISO, SOC2",icon:f.Z,tone:"positive"}];return a.jsx("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2 xl:grid-cols-4",children:t.map(e=>{let s=e.icon;return a.jsx(n.Zb,{className:(0,o.cn)("h-full border px-4 py-3 shadow-soft/40 backdrop-blur-sm",b[e.tone]),children:(0,a.jsxs)(n.aY,{className:"flex items-center justify-between space-x-3 px-0 py-0",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[a.jsx("p",{className:"text-[11px] font-medium uppercase tracking-[0.18em] text-slate-400",children:e.label}),a.jsx("p",{className:"text-xl font-semibold text-slate-50",children:e.value}),e.delta&&a.jsx("p",{className:"text-[11px] text-slate-400",children:e.delta})]}),a.jsx("div",{className:"flex h-9 w-9 items-center justify-center rounded-xl bg-slate-900/80 text-sky-300 shadow-soft/40",children:a.jsx(s,{className:"h-4 w-4"})})]})},e.label)})})}var j=t(8081);let g=[{name:"Critical",value:0,color:"#f97373"},{name:"High",value:0,color:"#fb923c"},{name:"Medium",value:0,color:"#eab308"},{name:"Low",value:0,color:"#22c55e"}];function ViolationsSeverityChart({data:e,loading:s}){let t=e?.length?e:g;return(0,a.jsxs)(n.Zb,{className:"h-full border border-slate-800/80 bg-slate-950/80 shadow-soft/40",children:[a.jsx(n.Ol,{className:"border-b border-slate-800/80 pb-3",children:a.jsx(n.ll,{className:"text-sm text-slate-100",children:"Violations by Severity"})}),a.jsx(n.aY,{className:"flex h-64 items-center justify-between gap-4 pt-4",children:s?a.jsx("div",{className:"flex h-full w-full items-center justify-center text-slate-400 text-sm",children:"Loading..."}):(0,a.jsxs)(a.Fragment,{children:[a.jsx("div",{className:"h-full flex-1",children:a.jsx(d.h,{children:a.jsx(x.u,{children:a.jsx(m.b,{data:t,dataKey:"value",nameKey:"name",innerRadius:48,outerRadius:72,paddingAngle:3,cornerRadius:6,children:t.map(e=>a.jsx(j.b,{fill:e.color,stroke:"none"},e.name))})})})}),a.jsx("div",{className:"w-32 space-y-2 text-[11px] text-slate-300",children:t.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1.5",children:[a.jsx("span",{className:"h-2.5 w-2.5 rounded-full",style:{backgroundColor:e.color}}),a.jsx("span",{children:e.name})]}),a.jsx("span",{className:"text-slate-400",children:e.value})]},e.name))})]})})]})}var v=t(34482),N=t(24300),y=t(35522),k=t(14839),w=t(54206),S=t(98741);let C=[{name:"CIS AWS",score:0},{name:"ISO 27001",score:0},{name:"SOC 2",score:0}];function FrameworkComplianceChart({data:e,loading:s}){let t=e?.length?e:C;return(0,a.jsxs)(n.Zb,{className:"h-full border border-slate-800/80 bg-slate-950/80 shadow-soft/40",children:[a.jsx(n.Ol,{className:"border-b border-slate-800/80 pb-3",children:a.jsx(n.ll,{className:"text-sm text-slate-100",children:"Compliance by Framework"})}),a.jsx(n.aY,{className:"h-64 pt-4",children:s?a.jsx("div",{className:"flex h-full items-center justify-center text-slate-400 text-sm",children:"Loading..."}):a.jsx(d.h,{children:(0,a.jsxs)(v.v,{data:t,barSize:28,children:[a.jsx(N.q,{strokeDasharray:"3 3",stroke:"#1e293b",vertical:!1}),a.jsx(y.K,{dataKey:"name",tickLine:!1,axisLine:!1,tick:{fill:"#9ca3af",fontSize:11}}),a.jsx(k.B,{tickLine:!1,axisLine:!1,tick:{fill:"#6b7280",fontSize:10},tickFormatter:e=>`${e}%`,domain:[0,100]}),a.jsx(w.u,{contentStyle:{background:"#020617",border:"1px solid #1e293b",fontSize:11},labelStyle:{color:"#e5e7eb"}}),a.jsx(S.$,{dataKey:"score",radius:[6,6,0,0],fill:"url(#frameworkGradient)"}),a.jsx("defs",{children:(0,a.jsxs)("linearGradient",{id:"frameworkGradient",x1:"0",y1:"0",x2:"1",y2:"1",children:[a.jsx("stop",{offset:"0%",stopColor:"#38bdf8"}),a.jsx("stop",{offset:"100%",stopColor:"#6366f1"})]})})]})})})]})}var _=t(34707),q=t(97106);function RiskTrendChart({data:e,loading:s}){let t=e?.length?e:[];return(0,a.jsxs)(n.Zb,{className:"h-full border border-slate-800/80 bg-slate-950/80 shadow-soft/40",children:[a.jsx(n.Ol,{className:"border-b border-slate-800/80 pb-3",children:a.jsx(n.ll,{className:"text-sm text-slate-100",children:"Risk & Compliance Trend"})}),a.jsx(n.aY,{className:"h-64 pt-4",children:s?a.jsx("div",{className:"flex h-full items-center justify-center text-slate-400 text-sm",children:"Loading..."}):0===t.length?a.jsx("div",{className:"flex h-full items-center justify-center text-slate-400 text-sm",children:"No scan history yet. Run scans to see trend."}):a.jsx(d.h,{children:(0,a.jsxs)(_.w,{data:t,children:[a.jsx(N.q,{strokeDasharray:"3 3",stroke:"#1e293b",vertical:!1}),a.jsx(y.K,{dataKey:"week",tickLine:!1,axisLine:!1,tick:{fill:"#9ca3af",fontSize:11}}),a.jsx(k.B,{tickLine:!1,axisLine:!1,tick:{fill:"#6b7280",fontSize:10},domain:[60,100],tickFormatter:e=>`${e}%`}),a.jsx(w.u,{contentStyle:{background:"#020617",border:"1px solid #1e293b",fontSize:11},labelStyle:{color:"#e5e7eb"}}),a.jsx(q.x,{type:"monotone",dataKey:"score",stroke:"#38bdf8",strokeWidth:2,dot:{r:3,strokeWidth:1,stroke:"#0f172a",fill:"#38bdf8"},activeDot:{r:4}})]})})})]})}var P=t(11440),A=t.n(P);function SeverityPill({value:e}){let s=e.charAt(0).toUpperCase()+e.slice(1).toLowerCase(),t={critical:"bg-red-500/15 text-red-300 border border-red-500/40",high:"bg-orange-500/15 text-orange-300 border border-orange-500/40",medium:"bg-amber-500/15 text-amber-300 border border-amber-500/40",low:"bg-emerald-500/15 text-emerald-300 border border-emerald-500/40",informational:"bg-slate-500/15 text-slate-300 border border-slate-500/40"},r=t[e.toLowerCase()]??t.medium;return a.jsx("span",{className:(0,o.cn)("inline-flex items-center rounded-full px-2 py-0.5 text-[11px] font-medium",r),children:s})}function formatTimeAgo(e){let s=new Date(e),t=new Date,a=Math.floor((t.getTime()-s.getTime())/1e3);return a<60?"just now":a<3600?`${Math.floor(a/60)} min ago`:a<86400?`${Math.floor(a/3600)} hr ago`:`${Math.floor(a/86400)} days ago`}function RecentFindingsTable({findings:e,total:s,onRefresh:t}){let r=e??[];return(0,a.jsxs)(n.Zb,{className:"h-full border border-slate-800/80 bg-slate-950/80 shadow-soft/40",children:[(0,a.jsxs)(n.Ol,{className:"flex flex-row items-center justify-between border-b border-slate-800/80 pb-3",children:[a.jsx(n.ll,{className:"text-sm text-slate-100",children:"Recent Findings"}),a.jsx(A(),{href:"/findings",children:a.jsx(i.z,{variant:"ghost",size:"sm",className:"text-[11px] text-sky-300 hover:text-sky-200",children:"View all"})})]}),a.jsx(n.aY,{className:"pt-3",children:a.jsx("div",{className:"overflow-hidden rounded-lg border border-slate-800/80",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-slate-800 text-xs",children:[a.jsx("thead",{className:"bg-slate-950/60 text-[11px] uppercase tracking-[0.16em] text-slate-400",children:(0,a.jsxs)("tr",{children:[a.jsx("th",{className:"px-4 py-2 text-left font-medium",children:"Resource"}),a.jsx("th",{className:"px-4 py-2 text-left font-medium",children:"Issue"}),a.jsx("th",{className:"px-4 py-2 text-left font-medium",children:"Severity"}),a.jsx("th",{className:"px-4 py-2 text-left font-medium",children:"Framework"}),a.jsx("th",{className:"px-4 py-2 text-left font-medium",children:"Last detected"}),a.jsx("th",{className:"px-4 py-2 text-right font-medium",children:"Action"})]})}),a.jsx("tbody",{className:"divide-y divide-slate-800/80 bg-slate-950/40",children:0===r.length?a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"px-4 py-8 text-center text-slate-400 text-sm",children:"No findings yet. Run a scan to discover issues."})}):r.map((e,s)=>(0,a.jsxs)("tr",{className:(0,o.cn)("hover:bg-slate-900/70",s%2==1&&"bg-slate-950/60"),children:[a.jsx("td",{className:"max-w-[160px] truncate px-4 py-2 text-[11px] text-slate-100",children:e.resourceId}),a.jsx("td",{className:"px-4 py-2 text-[11px] text-slate-200",children:e.message}),a.jsx("td",{className:"px-4 py-2",children:a.jsx(SeverityPill,{value:e.severity})}),a.jsx("td",{className:"px-4 py-2 text-[11px] text-slate-300",children:e.controlIds?.[0]??"—"}),a.jsx("td",{className:"px-4 py-2 text-[11px] text-slate-400",children:formatTimeAgo(e.lastSeenAt)}),a.jsx("td",{className:"px-4 py-2 text-right",children:a.jsx("span",{className:"text-[11px] text-sky-300",children:e.rule?.name??"See rule"})})]},e.id))})]})})})]})}var L=t(9083);function DashboardClient(){let[e,s]=(0,r.useState)(!0),[t,n]=(0,r.useState)(null),[o,c]=(0,r.useState)(null),[d,x]=(0,r.useState)(null),[m,h]=(0,r.useState)([]),[u,p]=(0,r.useState)([]),[f,b]=(0,r.useState)({items:[],total:0}),[j,g]=(0,r.useState)([]),refresh=async()=>{s(!0);try{n(null);let[e,s,t,a,r,l]=await Promise.all([(0,L.TN)(),(0,L.AW)(),(0,L.r5)(),(0,L.tY)(),(0,L._M)({limit:10,offset:0}),(0,L.Cn)()]);c(e),x(s),h(t),p(a),b(r),g(l)}catch(e){n(e instanceof Error?e.message:"Failed to load dashboard")}finally{s(!1)}};return((0,r.useEffect)(()=>{refresh();let onScanComplete=()=>refresh();return window.addEventListener("scan-complete",onScanComplete),()=>window.removeEventListener("scan-complete",onScanComplete)},[]),e&&!o)?a.jsx("div",{className:"flex min-h-[400px] items-center justify-center",children:a.jsx("div",{className:"text-sm text-slate-400",children:"Loading dashboard..."})}):t&&!o?a.jsx("div",{className:"rounded-lg border border-amber-500/30 bg-amber-950/20 p-4 text-sm text-amber-200",children:t}):(0,a.jsxs)("div",{className:"space-y-4",children:[a.jsx("div",{className:"flex justify-end",children:(0,a.jsxs)(i.z,{variant:"ghost",size:"sm",onClick:refresh,disabled:e,className:"text-[11px] text-slate-400 hover:text-slate-200",children:[a.jsx(l.Z,{className:"mr-1.5 h-3.5 w-3.5"}),"Refresh"]})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-[minmax(0,1.4fr)_minmax(0,1.2fr)]",children:[a.jsx(ComplianceScoreCard,{score:d?.score??100,loading:e,lastEvaluated:d?.lastEvaluated,resourceCount:d?.resourceCount??0}),a.jsx(SummaryMetrics,{metrics:o,loading:e})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-[minmax(0,1.2fr)_minmax(0,1.2fr)]",children:[a.jsx(ViolationsSeverityChart,{data:m,loading:e}),a.jsx(FrameworkComplianceChart,{data:u,loading:e})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-[minmax(0,1.3fr)_minmax(0,1.1fr)]",children:[a.jsx(RecentFindingsTable,{findings:f.items,total:f.total,onRefresh:refresh}),a.jsx(RiskTrendChart,{data:j,loading:e})]})]})}},48977:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>DashboardPage});var a=t(4656),r=t(95153);let l=(0,r.createProxy)(String.raw`/Users/pritamkhergade/cursor/cs/frontend/components/Dashboard/dashboard-client.tsx`),{__esModule:i,$$typeof:n}=l;l.default;let o=(0,r.createProxy)(String.raw`/Users/pritamkhergade/cursor/cs/frontend/components/Dashboard/dashboard-client.tsx#DashboardClient`);function DashboardPage(){return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-1",children:[a.jsx("h1",{className:"text-lg font-semibold tracking-tight text-slate-50",children:"Global Compliance Overview"}),a.jsx("p",{className:"text-xs text-slate-400",children:"High-level posture across all connected AWS accounts and frameworks."})]}),a.jsx(o,{})]})}}};var s=require("../../webpack-runtime.js");s.C(e);var __webpack_exec__=e=>s(s.s=e),t=s.X(0,[472,670,745,668,940,861,258],()=>__webpack_exec__(79626));module.exports=t})();
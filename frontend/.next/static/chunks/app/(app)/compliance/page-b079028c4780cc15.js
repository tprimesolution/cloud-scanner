(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[169],{65531:function(e,t,s){"use strict";s.d(t,{Z:function(){return createLucideIcon}});var a=s(2265);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let toKebabCase=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),mergeClasses=(...e)=>e.filter((e,t,s)=>!!e&&s.indexOf(e)===t).join(" ");/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var r={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,a.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:s=2,absoluteStrokeWidth:n,className:i="",children:l,iconNode:c,...o},d)=>(0,a.createElement)("svg",{ref:d,...r,width:t,height:t,stroke:e,strokeWidth:n?24*Number(s)/Number(t):s,className:mergeClasses("lucide",i),...o},[...c.map(([e,t])=>(0,a.createElement)(e,t)),...Array.isArray(l)?l:[l]])),createLucideIcon=(e,t)=>{let s=(0,a.forwardRef)(({className:s,...r},i)=>(0,a.createElement)(n,{ref:i,iconNode:t,className:mergeClasses(`lucide-${toKebabCase(e)}`,s),...r}));return s.displayName=`${e}`,s}},83523:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(65531);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a.Z)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},49036:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(65531);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a.Z)("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])},11929:function(e,t,s){Promise.resolve().then(s.bind(s,51693))},51693:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return CompliancePage}});var a=s(57437),r=s(2265),n=s(61396),i=s.n(n),l=s(49598),c=s(23611),o=s(88062),d=s(49036),u=s(65531);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let m=(0,u.Z)("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);var g=s(83523);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let x=(0,u.Z)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);function CompliancePage(){var e;let[t,s]=(0,r.useState)([]),[n,u]=(0,r.useState)([]),[f,h]=(0,r.useState)(null),[b,p]=(0,r.useState)(!0),[w,v]=(0,r.useState)("frameworks"),[N,y]=(0,r.useState)(null),[j,C]=(0,r.useState)(null),[k,S]=(0,r.useState)([]),[F,I]=(0,r.useState)([]);(0,r.useEffect)(()=>{Promise.all([(0,o.PA)(),(0,o.CP)(),(0,o.AW)()]).then(e=>{let[t,a,r]=e;s(t),u(a),h(r)}).catch(console.error).finally(()=>p(!1))},[]);let loadFrameworkFindings=e=>{if(N===e){y(null),S([]);return}y(e),(0,o.IQ)(e,{limit:20}).then(e=>S(e.items)).catch(console.error)},loadCategoryFindings=e=>{if(j===e){C(null),I([]);return}C(e),(0,o.pC)(e,{limit:20}).then(e=>I(e.items)).catch(console.error)};return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-lg font-semibold tracking-tight text-slate-50",children:"Compliance"}),(0,a.jsxs)("p",{className:"text-xs text-slate-400",children:[b?"Loading...":"".concat(t.length," frameworks & ").concat(n.length," categories")," — framework-specific and category views."]})]}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,a.jsxs)(l.Zb,{className:"border border-slate-800/80 bg-slate-950/80",children:[(0,a.jsx)(l.Ol,{className:"border-b border-slate-800/80 pb-3",children:(0,a.jsx)(l.ll,{className:"text-sm text-slate-100",children:"Overall Score"})}),(0,a.jsxs)(l.aY,{className:"pt-4",children:[b?(0,a.jsx)("p",{className:"text-slate-400",children:"Loading..."}):(0,a.jsxs)("div",{className:"text-3xl font-semibold text-slate-50",children:[null!==(e=null==f?void 0:f.score)&&void 0!==e?e:0,"%"]}),(0,a.jsxs)("p",{className:"mt-2 text-[11px] text-slate-400",children:["Last evaluated:"," ",(null==f?void 0:f.lastEvaluated)?new Date(f.lastEvaluated).toLocaleString():"Never"]})]})]}),(0,a.jsxs)(l.Zb,{className:"border border-slate-800/80 bg-slate-950/80",children:[(0,a.jsx)(l.Ol,{className:"border-b border-slate-800/80 pb-3",children:(0,a.jsx)(l.ll,{className:"text-sm text-slate-100",children:"View by"})}),(0,a.jsxs)(l.aY,{className:"pt-4 flex gap-2",children:[(0,a.jsxs)(c.z,{variant:"frameworks"===w?"default":"outline",size:"sm",onClick:()=>v("frameworks"),className:"text-xs",children:[(0,a.jsx)(d.Z,{className:"mr-1.5 h-3.5 w-3.5"}),t.length," Frameworks"]}),(0,a.jsxs)(c.z,{variant:"categories"===w?"default":"outline",size:"sm",onClick:()=>v("categories"),className:"text-xs",children:[(0,a.jsx)(m,{className:"mr-1.5 h-3.5 w-3.5"}),n.length," Categories"]})]})]})]}),(0,a.jsxs)(l.Zb,{className:"border border-slate-800/80 bg-slate-950/80",children:[(0,a.jsx)(l.Ol,{className:"border-b border-slate-800/80 pb-3",children:(0,a.jsx)(l.ll,{className:"text-sm text-slate-100",children:"frameworks"===w?"Compliance Frameworks":"Categories"})}),(0,a.jsx)(l.aY,{className:"pt-4",children:b?(0,a.jsx)("p",{className:"text-slate-400",children:"Loading..."}):"frameworks"===w?0===t.length?(0,a.jsx)("p",{className:"text-slate-400 text-sm py-4",children:"No frameworks available."}):(0,a.jsx)("div",{className:"space-y-1 max-h-[400px] overflow-y-auto",children:t.map(e=>(0,a.jsxs)("div",{className:"border-b border-slate-800/50 last:border-0",children:[(0,a.jsxs)("button",{onClick:()=>loadFrameworkFindings(e.frameworkId),className:"w-full flex items-center justify-between py-2 px-2 rounded hover:bg-slate-800/50 text-left text-sm",children:[(0,a.jsxs)("span",{className:"flex items-center gap-2",children:[N===e.frameworkId?(0,a.jsx)(g.Z,{className:"h-4 w-4 text-slate-400"}):(0,a.jsx)(x,{className:"h-4 w-4 text-slate-400"}),(0,a.jsx)("span",{className:"text-slate-200",children:e.name}),e.findingCount>0&&(0,a.jsx)("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-amber-500/20 text-amber-400",children:e.findingCount})]}),(0,a.jsxs)("span",{className:e.score>=80?"text-emerald-400 font-medium":"text-amber-400 font-medium",children:[e.score,"%"]})]}),N===e.frameworkId&&k.length>0&&(0,a.jsxs)("div",{className:"pl-6 pb-3 space-y-1.5 text-xs",children:[k.map(e=>(0,a.jsxs)("div",{className:"py-1.5 px-2 rounded bg-slate-900/60 border border-slate-800/50",children:[(0,a.jsx)("span",{className:"text-amber-400 font-medium",children:e.ruleCode}),(0,a.jsx)("span",{className:"text-slate-400 mx-1",children:"—"}),(0,a.jsx)("span",{className:"text-slate-300 truncate",children:e.message}),(0,a.jsxs)("span",{className:"text-slate-500 ml-1",children:["(",e.resourceId,")"]})]},e.id)),(0,a.jsx)(i(),{href:"/findings?framework=".concat(e.frameworkId),children:(0,a.jsx)(c.z,{variant:"ghost",size:"sm",className:"text-[10px] h-6",children:"View all →"})})]})]},e.frameworkId))}):0===n.length?(0,a.jsx)("p",{className:"text-slate-400 text-sm py-4",children:"No categories available."}):(0,a.jsx)("div",{className:"space-y-1 max-h-[400px] overflow-y-auto",children:n.map(e=>(0,a.jsxs)("div",{className:"border-b border-slate-800/50 last:border-0",children:[(0,a.jsx)("button",{onClick:()=>loadCategoryFindings(e.categoryId),className:"w-full flex items-center justify-between py-2 px-2 rounded hover:bg-slate-800/50 text-left text-sm",children:(0,a.jsxs)("span",{className:"flex items-center gap-2",children:[j===e.categoryId?(0,a.jsx)(g.Z,{className:"h-4 w-4 text-slate-400"}):(0,a.jsx)(x,{className:"h-4 w-4 text-slate-400"}),(0,a.jsx)("span",{className:"text-slate-200",children:e.name}),e.findingCount>0&&(0,a.jsx)("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-amber-500/20 text-amber-400",children:e.findingCount})]})}),j===e.categoryId&&F.length>0&&(0,a.jsxs)("div",{className:"pl-6 pb-3 space-y-1.5 text-xs",children:[F.map(e=>(0,a.jsxs)("div",{className:"py-1.5 px-2 rounded bg-slate-900/60 border border-slate-800/50",children:[(0,a.jsx)("span",{className:"text-amber-400 font-medium",children:e.ruleCode}),(0,a.jsx)("span",{className:"text-slate-400 mx-1",children:"—"}),(0,a.jsx)("span",{className:"text-slate-300 truncate",children:e.message}),(0,a.jsxs)("span",{className:"text-slate-500 ml-1",children:["(",e.resourceId,")"]})]},e.id)),(0,a.jsx)(i(),{href:"/findings?category=".concat(e.categoryId),children:(0,a.jsx)(c.z,{variant:"ghost",size:"sm",className:"text-[10px] h-6",children:"View all →"})})]})]},e.categoryId))})})]}),(0,a.jsx)(i(),{href:"/findings",children:(0,a.jsx)(c.z,{variant:"outline",size:"sm",children:"View All Findings"})})]})}},23611:function(e,t,s){"use strict";s.d(t,{z:function(){return o}});var a=s(57437),r=s(2265),n=s(74972),i=s(39213),l=s(81628);let c=(0,i.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-60",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-sm hover:bg-primary/90",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",outline:"border border-border bg-background hover:bg-accent hover:text-accent-foreground",ghost:"hover:bg-accent hover:text-accent-foreground text-muted-foreground",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",subtle:"bg-muted text-muted-foreground hover:bg-muted/80 border border-transparent"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-6",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),o=r.forwardRef((e,t)=>{let{className:s,variant:r,size:i,asChild:o=!1,...d}=e,u=o?n.g7:"button";return(0,a.jsx)(u,{className:(0,l.cn)(c({variant:r,size:i,className:s})),ref:t,...d})});o.displayName="Button"},49598:function(e,t,s){"use strict";s.d(t,{Ol:function(){return CardHeader},Zb:function(){return Card},aY:function(){return CardContent},ll:function(){return CardTitle}});var a=s(57437);s(2265);var r=s(81628);function Card(e){let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,r.cn)("rounded-xl border border-border bg-card text-card-foreground shadow-soft/60",t),...s})}function CardHeader(e){let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,r.cn)("flex flex-col space-y-1.5 border-b border-border/60 px-6 py-4",t),...s})}function CardTitle(e){let{className:t,...s}=e;return(0,a.jsx)("h3",{className:(0,r.cn)("text-base font-semibold leading-tight",t),...s})}function CardContent(e){let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,r.cn)("px-6 py-5",t),...s})}},81628:function(e,t,s){"use strict";s.d(t,{cn:function(){return cn}});var a=s(57042),r=s(74769);function cn(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,r.m6)((0,a.W)(t))}},88062:function(e,t,s){"use strict";s.d(t,{$c:function(){return getRules},AW:function(){return getComplianceScore},CP:function(){return getCategories},Cn:function(){return getRiskTrend},IQ:function(){return getFrameworkFindings},PA:function(){return getFrameworks},PF:function(){return updateFindingStatus},Qe:function(){return getScannerStatus},TN:function(){return getDashboardMetrics},Vh:function(){return getAssets},_M:function(){return getFindings},ku:function(){return getScanJobs},lZ:function(){return triggerScan},pC:function(){return getCategoryFindings},r5:function(){return getFindingsBySeverity},tY:function(){return getFrameworkScores}});var a=s(92173),r=s(62601);let n=a.Z.create({baseURL:r.env.NEXT_PUBLIC_API_BASE_URL||"http://localhost:8080/api"});async function getScannerStatus(){let{data:e}=await n.get("/scanner/status");return e}async function triggerScan(){let{data:e}=await n.post("/scanner/scan");return e}async function getFindings(e){let{data:t}=await n.get("/scanner/findings",{params:e});return t}async function updateFindingStatus(e,t){await n.post("/scanner/findings/".concat(e,"/status"),{status:t})}async function getDashboardMetrics(){let{data:e}=await n.get("/dashboard/metrics");return e}async function getComplianceScore(){let{data:e}=await n.get("/dashboard/compliance-score");return e}async function getFindingsBySeverity(){let{data:e}=await n.get("/dashboard/findings-by-severity");return e}async function getFrameworkScores(){let{data:e}=await n.get("/dashboard/framework-scores");return e}async function getRiskTrend(){let{data:e}=await n.get("/dashboard/risk-trend");return e}async function getScanJobs(e){let{data:t}=await n.get("/scanner/jobs",{params:e?{limit:e}:void 0});return t}async function getRules(){let{data:e}=await n.get("/rules");return e}async function getFrameworks(){let{data:e}=await n.get("/compliance/frameworks");return e}async function getFrameworkFindings(e,t){let{data:s}=await n.get("/compliance/frameworks/".concat(e,"/findings"),{params:t});return s}async function getCategories(){let{data:e}=await n.get("/compliance/categories");return e}async function getCategoryFindings(e,t){let{data:s}=await n.get("/compliance/categories/".concat(e,"/findings"),{params:t});return s}async function getAssets(e){let{data:t}=await n.get("/assets",{params:e});return t}}},function(e){e.O(0,[895,384,382,971,472,744],function(){return e(e.s=11929)}),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[13],{12627:function(e,t,n){Promise.resolve().then(n.bind(n,48427))},48427:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return FindingsPage}});var a=n(57437),s=n(2265),i=n(24033),c=n(49598),o=n(23611),l=n(88062),d=n(81628);function SeverityPill(e){var t;let{value:n}=e,s=n.charAt(0).toUpperCase()+n.slice(1).toLowerCase();return(0,a.jsx)("span",{className:(0,d.cn)("inline-flex items-center rounded-full px-2 py-0.5 text-[11px] font-medium",null!==(t=({critical:"bg-red-500/15 text-red-300 border border-red-500/40",high:"bg-orange-500/15 text-orange-300 border border-orange-500/40",medium:"bg-amber-500/15 text-amber-300 border border-amber-500/40",low:"bg-emerald-500/15 text-emerald-300 border border-emerald-500/40"})[n.toLowerCase()])&&void 0!==t?t:"bg-slate-500/15"),children:s})}function FindingsPage(){var e,t;let n=(0,i.useSearchParams)(),[d,u]=(0,s.useState)([]),[f,g]=(0,s.useState)(0),[x,m]=(0,s.useState)(!0),[p,h]=(0,s.useState)(""),[v,b]=(0,s.useState)(""),[y,w]=(0,s.useState)(0),j=null!==(e=null==n?void 0:n.get("framework"))&&void 0!==e?e:void 0,C=null!==(t=null==n?void 0:n.get("category"))&&void 0!==t?t:void 0,fetchFindings=async()=>{m(!0);try{let e=await (0,l._M)({status:p||void 0,severity:v||void 0,framework:j,category:C,limit:20,offset:y});u(e.items),g(e.total)}catch(e){console.error(e)}finally{m(!1)}};(0,s.useEffect)(()=>{fetchFindings()},[p,v,j,C,y]);let handleStatusChange=async(e,t)=>{try{await (0,l.PF)(e,t),fetchFindings()}catch(e){console.error(e)}};return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-lg font-semibold tracking-tight text-slate-50",children:"Findings"}),(0,a.jsx)("p",{className:"text-xs text-slate-400",children:j||C?"Filtered by ".concat([j&&"framework: ".concat(j),C&&"category: ".concat(C)].filter(Boolean).join(" & ")):"Security and compliance findings from scans."})]}),(0,a.jsxs)(c.Zb,{className:"border border-slate-800/80 bg-slate-950/80",children:[(0,a.jsxs)(c.Ol,{className:"flex flex-row items-center justify-between border-b border-slate-800/80 pb-3",children:[(0,a.jsx)(c.ll,{className:"text-sm text-slate-100",children:"All Findings"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)("select",{value:p,onChange:e=>{h(e.target.value),w(0)},className:"rounded border border-slate-700 bg-slate-900 px-2 py-1 text-[11px] text-slate-200",children:[(0,a.jsx)("option",{value:"",children:"All statuses"}),(0,a.jsx)("option",{value:"open",children:"Open"}),(0,a.jsx)("option",{value:"acknowledged",children:"Acknowledged"}),(0,a.jsx)("option",{value:"resolved",children:"Resolved"}),(0,a.jsx)("option",{value:"suppressed",children:"Suppressed"})]}),(0,a.jsxs)("select",{value:v,onChange:e=>{b(e.target.value),w(0)},className:"rounded border border-slate-700 bg-slate-900 px-2 py-1 text-[11px] text-slate-200",children:[(0,a.jsx)("option",{value:"",children:"All severities"}),(0,a.jsx)("option",{value:"critical",children:"Critical"}),(0,a.jsx)("option",{value:"high",children:"High"}),(0,a.jsx)("option",{value:"medium",children:"Medium"}),(0,a.jsx)("option",{value:"low",children:"Low"})]})]})]}),(0,a.jsx)(c.aY,{className:"pt-3",children:x?(0,a.jsx)("div",{className:"py-8 text-center text-slate-400",children:"Loading..."}):0===d.length?(0,a.jsx)("div",{className:"py-8 text-center text-slate-400",children:"No findings. Run a scan to discover issues."}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-slate-800 text-xs",children:[(0,a.jsx)("thead",{className:"bg-slate-950/60 text-[11px] uppercase tracking-[0.16em] text-slate-400",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-4 py-2 text-left",children:"Resource"}),(0,a.jsx)("th",{className:"px-4 py-2 text-left",children:"Issue"}),(0,a.jsx)("th",{className:"px-4 py-2 text-left",children:"Severity"}),(0,a.jsx)("th",{className:"px-4 py-2 text-left",children:"Framework"}),(0,a.jsx)("th",{className:"px-4 py-2 text-left",children:"Status"}),(0,a.jsx)("th",{className:"px-4 py-2 text-right",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-slate-800/80",children:d.map(e=>{var t,n;return(0,a.jsxs)("tr",{className:"hover:bg-slate-900/70",children:[(0,a.jsx)("td",{className:"max-w-[180px] truncate px-4 py-2 text-slate-100",children:e.resourceId}),(0,a.jsx)("td",{className:"px-4 py-2 text-slate-200",children:e.message}),(0,a.jsx)("td",{className:"px-4 py-2",children:(0,a.jsx)(SeverityPill,{value:e.severity})}),(0,a.jsx)("td",{className:"px-4 py-2 text-slate-300",children:null!==(n=null===(t=e.controlIds)||void 0===t?void 0:t[0])&&void 0!==n?n:"—"}),(0,a.jsx)("td",{className:"px-4 py-2 text-slate-400",children:e.status}),(0,a.jsx)("td",{className:"px-4 py-2 text-right",children:"open"===e.status&&(0,a.jsx)(o.z,{size:"sm",variant:"outline",className:"h-7 text-[11px]",onClick:()=>handleStatusChange(e.id,"acknowledged"),children:"Acknowledge"})})]},e.id)})})]})}),(0,a.jsxs)("div",{className:"mt-4 flex items-center justify-between text-[11px] text-slate-400",children:[(0,a.jsxs)("span",{children:["Showing ",y+1,"–",Math.min(y+20,f)," of ",f]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(o.z,{variant:"ghost",size:"sm",disabled:0===y,onClick:()=>w(e=>Math.max(0,e-20)),children:"Previous"}),(0,a.jsx)(o.z,{variant:"ghost",size:"sm",disabled:y+20>=f,onClick:()=>w(e=>e+20),children:"Next"})]})]})]})})]})]})}},23611:function(e,t,n){"use strict";n.d(t,{z:function(){return d}});var a=n(57437),s=n(2265),i=n(74972),c=n(39213),o=n(81628);let l=(0,c.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-60",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-sm hover:bg-primary/90",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",outline:"border border-border bg-background hover:bg-accent hover:text-accent-foreground",ghost:"hover:bg-accent hover:text-accent-foreground text-muted-foreground",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",subtle:"bg-muted text-muted-foreground hover:bg-muted/80 border border-transparent"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-6",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),d=s.forwardRef((e,t)=>{let{className:n,variant:s,size:c,asChild:d=!1,...u}=e,f=d?i.g7:"button";return(0,a.jsx)(f,{className:(0,o.cn)(l({variant:s,size:c,className:n})),ref:t,...u})});d.displayName="Button"},49598:function(e,t,n){"use strict";n.d(t,{Ol:function(){return CardHeader},Zb:function(){return Card},aY:function(){return CardContent},ll:function(){return CardTitle}});var a=n(57437);n(2265);var s=n(81628);function Card(e){let{className:t,...n}=e;return(0,a.jsx)("div",{className:(0,s.cn)("rounded-xl border border-border bg-card text-card-foreground shadow-soft/60",t),...n})}function CardHeader(e){let{className:t,...n}=e;return(0,a.jsx)("div",{className:(0,s.cn)("flex flex-col space-y-1.5 border-b border-border/60 px-6 py-4",t),...n})}function CardTitle(e){let{className:t,...n}=e;return(0,a.jsx)("h3",{className:(0,s.cn)("text-base font-semibold leading-tight",t),...n})}function CardContent(e){let{className:t,...n}=e;return(0,a.jsx)("div",{className:(0,s.cn)("px-6 py-5",t),...n})}},81628:function(e,t,n){"use strict";n.d(t,{cn:function(){return cn}});var a=n(57042),s=n(74769);function cn(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,s.m6)((0,a.W)(t))}},88062:function(e,t,n){"use strict";n.d(t,{$c:function(){return getRules},AW:function(){return getComplianceScore},CP:function(){return getCategories},Cn:function(){return getRiskTrend},Cr:function(){return getControlChecks},Hj:function(){return getFrameworkCriteria},IQ:function(){return getFrameworkFindings},MF:function(){return getEnterpriseFrameworks},PA:function(){return getFrameworks},PF:function(){return updateFindingStatus},Qe:function(){return getScannerStatus},TN:function(){return getDashboardMetrics},Tg:function(){return updateCriteriaScope},Vh:function(){return getAssets},_M:function(){return getFindings},ku:function(){return getScanJobs},lZ:function(){return triggerScan},pC:function(){return getCategoryFindings},qu:function(){return getFrameworkSummary},r5:function(){return getFindingsBySeverity},tY:function(){return getFrameworkScores},vO:function(){return getCriteriaControls}});var a=n(92173),s=n(62601);let i=a.Z.create({baseURL:s.env.NEXT_PUBLIC_API_BASE_URL||"http://localhost:8080/api"});async function getScannerStatus(){let{data:e}=await i.get("/scanner/status");return e}async function triggerScan(){let{data:e}=await i.post("/scanner/scan");return e}async function getFindings(e){let{data:t}=await i.get("/scanner/findings",{params:e});return t}async function updateFindingStatus(e,t){await i.post("/scanner/findings/".concat(e,"/status"),{status:t})}async function getDashboardMetrics(){let{data:e}=await i.get("/dashboard/metrics");return e}async function getComplianceScore(){let{data:e}=await i.get("/dashboard/compliance-score");return e}async function getFindingsBySeverity(){let{data:e}=await i.get("/dashboard/findings-by-severity");return e}async function getFrameworkScores(){let{data:e}=await i.get("/dashboard/framework-scores");return e}async function getRiskTrend(){let{data:e}=await i.get("/dashboard/risk-trend");return e}async function getScanJobs(e){let{data:t}=await i.get("/scanner/jobs",{params:e?{limit:e}:void 0});return t}async function getRules(){let{data:e}=await i.get("/rules");return e}async function getFrameworks(){let{data:e}=await i.get("/compliance/frameworks");return e}async function getFrameworkFindings(e,t){let{data:n}=await i.get("/compliance/frameworks/".concat(e,"/findings"),{params:t});return n}async function getEnterpriseFrameworks(){let{data:e}=await i.get("/frameworks");return e}async function getFrameworkSummary(e){let{data:t}=await i.get("/frameworks/".concat(e,"/summary"));return t}async function getFrameworkCriteria(e){let{data:t}=await i.get("/frameworks/".concat(e,"/criteria"));return t}async function updateCriteriaScope(e,t){let{data:n}=await i.post("/criteria/".concat(e,"/scope"),{scope:t});return n}async function getCriteriaControls(e){let{data:t}=await i.get("/criteria/".concat(e,"/controls"));return t}async function getControlChecks(e){let{data:t}=await i.get("/controls/".concat(e,"/checks"));return t}async function getCategories(){let{data:e}=await i.get("/compliance/categories");return e}async function getCategoryFindings(e,t){let{data:n}=await i.get("/compliance/categories/".concat(e,"/findings"),{params:t});return n}async function getAssets(e){let{data:t}=await i.get("/assets",{params:e});return t}},24033:function(e,t,n){e.exports=n(50094)},74972:function(e,t,n){"use strict";function _extends(){return(_extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(null,arguments)}n.d(t,{g7:function(){return s}});var a=n(2265);function $6ed0406888f73fc4$var$setRef(e,t){"function"==typeof e?e(t):null!=e&&(e.current=t)}function $6ed0406888f73fc4$export$43e446d32b3d21af(...e){return t=>e.forEach(e=>$6ed0406888f73fc4$var$setRef(e,t))}let s=(0,a.forwardRef)((e,t)=>{let{children:n,...s}=e,c=a.Children.toArray(n),o=c.find($5e63c961fc1ce211$var$isSlottable);if(o){let e=o.props.children,n=c.map(t=>t!==o?t:a.Children.count(e)>1?a.Children.only(null):(0,a.isValidElement)(e)?e.props.children:null);return(0,a.createElement)(i,_extends({},s,{ref:t}),(0,a.isValidElement)(e)?(0,a.cloneElement)(e,void 0,n):null)}return(0,a.createElement)(i,_extends({},s,{ref:t}),n)});s.displayName="Slot";let i=(0,a.forwardRef)((e,t)=>{let{children:n,...s}=e;return(0,a.isValidElement)(n)?(0,a.cloneElement)(n,{...$5e63c961fc1ce211$var$mergeProps(s,n.props),ref:t?$6ed0406888f73fc4$export$43e446d32b3d21af(t,n.ref):n.ref}):a.Children.count(n)>1?a.Children.only(null):null});i.displayName="SlotClone";let $5e63c961fc1ce211$export$d9f1ccf0bdb05d45=({children:e})=>(0,a.createElement)(a.Fragment,null,e);function $5e63c961fc1ce211$var$isSlottable(e){return(0,a.isValidElement)(e)&&e.type===$5e63c961fc1ce211$export$d9f1ccf0bdb05d45}function $5e63c961fc1ce211$var$mergeProps(e,t){let n={...t};for(let a in t){let s=e[a],i=t[a],c=/^on[A-Z]/.test(a);c?s&&i?n[a]=(...e)=>{i(...e),s(...e)}:s&&(n[a]=s):"style"===a?n[a]={...s,...i}:"className"===a&&(n[a]=[s,i].filter(Boolean).join(" "))}return{...e,...n}}},39213:function(e,t,n){"use strict";function r(e){var t,n,a="";if("string"==typeof e||"number"==typeof e)a+=e;else if("object"==typeof e){if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=r(e[t]))&&(a&&(a+=" "),a+=n);else for(t in e)e[t]&&(a&&(a+=" "),a+=t)}return a}function clsx(){for(var e,t,n=0,a="";n<arguments.length;)(e=arguments[n++])&&(t=r(e))&&(a&&(a+=" "),a+=t);return a}n.d(t,{j:function(){return cva}});let falsyToString=e=>"boolean"==typeof e?"".concat(e):0===e?"0":e,a=clsx,cva=(e,t)=>n=>{var s;if((null==t?void 0:t.variants)==null)return a(e,null==n?void 0:n.class,null==n?void 0:n.className);let{variants:i,defaultVariants:c}=t,o=Object.keys(i).map(e=>{let t=null==n?void 0:n[e],a=null==c?void 0:c[e];if(null===t)return null;let s=falsyToString(t)||falsyToString(a);return i[e][s]}),l=n&&Object.entries(n).reduce((e,t)=>{let[n,a]=t;return void 0===a||(e[n]=a),e},{}),d=null==t?void 0:null===(s=t.compoundVariants)||void 0===s?void 0:s.reduce((e,t)=>{let{class:n,className:a,...s}=t;return Object.entries(s).every(e=>{let[t,n]=e;return Array.isArray(n)?n.includes({...c,...l}[t]):({...c,...l})[t]===n})?[...e,n,a]:e},[]);return a(e,o,d,null==n?void 0:n.class,null==n?void 0:n.className)}}},function(e){e.O(0,[895,384,971,472,744],function(){return e(e.s=12627)}),_N_E=e.O()}]);
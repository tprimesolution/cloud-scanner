(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[85],{65531:function(e,t,n){"use strict";n.d(t,{Z:function(){return createLucideIcon}});var s=n(2265);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let toKebabCase=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),mergeClasses=(...e)=>e.filter((e,t,n)=>!!e&&n.indexOf(e)===t).join(" ");/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var a={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let c=(0,s.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:c,className:l="",children:i,iconNode:o,...d},u)=>(0,s.createElement)("svg",{ref:u,...a,width:t,height:t,stroke:e,strokeWidth:c?24*Number(n)/Number(t):n,className:mergeClasses("lucide",l),...d},[...o.map(([e,t])=>(0,s.createElement)(e,t)),...Array.isArray(i)?i:[i]])),createLucideIcon=(e,t)=>{let n=(0,s.forwardRef)(({className:n,...a},l)=>(0,s.createElement)(c,{ref:l,iconNode:t,className:mergeClasses(`lucide-${toKebabCase(e)}`,n),...a}));return n.displayName=`${e}`,n}},63715:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var s=n(65531);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s.Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},94900:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var s=n(65531);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s.Z)("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]])},64280:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var s=n(65531);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s.Z)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},84936:function(e,t,n){Promise.resolve().then(n.bind(n,52359))},52359:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return ScannerPage}});var s=n(57437),a=n(2265),c=n(49598),l=n(23611),i=n(88062),o=n(64280),d=n(63715),u=n(94900);function ScannerPage(){var e;let[t,n]=(0,a.useState)(null),[f,g]=(0,a.useState)([]),[m,x]=(0,a.useState)(!1),[h,p]=(0,a.useState)(null),refresh=async()=>{try{let[e,t]=await Promise.all([(0,i.Qe)(),(0,i.ku)(15)]);n(e),g(t)}catch(e){console.error(e)}};(0,a.useEffect)(()=>{refresh();let e=setInterval(refresh,5e3);return()=>clearInterval(e)},[]);let handleRunScan=async()=>{if(!m&&(null==t||!t.scanInProgress)){x(!0),p(null);try{let e=await (0,i.lZ)();p(e.triggered?"Scan started.":e.message),await refresh()}catch(e){p(e instanceof Error?e.message:"Scan failed")}finally{x(!1)}}};return(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,s.jsx)("h1",{className:"text-lg font-semibold tracking-tight text-slate-50",children:"Scanner"}),(0,s.jsx)("p",{className:"text-xs text-slate-400",children:"Run security scans and view scan history."})]}),(0,s.jsxs)(c.Zb,{className:"border border-slate-800/80 bg-slate-950/80",children:[(0,s.jsxs)(c.Ol,{className:"flex flex-row items-center justify-between border-b border-slate-800/80 pb-3",children:[(0,s.jsx)(c.ll,{className:"text-sm text-slate-100",children:"Scan Status"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)(l.z,{variant:"ghost",size:"sm",onClick:refresh,className:"text-[11px]",children:[(0,s.jsx)(o.Z,{className:"mr-1 h-3 w-3"}),"Refresh"]}),(0,s.jsxs)(l.z,{size:"sm",onClick:handleRunScan,disabled:m||(null==t?void 0:t.scanInProgress)===!0,className:"inline-flex items-center gap-1.5 rounded-lg border border-sky-500/50 bg-sky-500/10 px-3 text-[11px] font-medium text-sky-300 hover:bg-sky-500/20",children:[m||(null==t?void 0:t.scanInProgress)?(0,s.jsx)(d.Z,{className:"h-3.5 w-3.5 animate-spin"}):(0,s.jsx)(u.Z,{className:"h-3.5 w-3.5"}),m||(null==t?void 0:t.scanInProgress)?"Scanning...":"Run Scan"]})]})]}),(0,s.jsxs)(c.aY,{className:"pt-3 space-y-2",children:[h&&(0,s.jsx)("p",{className:"text-[11px] text-slate-400",children:h}),(0,s.jsxs)("div",{className:"flex gap-4 text-[11px]",children:[(0,s.jsxs)("span",{children:["Status:"," ",(0,s.jsx)("span",{className:(null==t?void 0:t.scanInProgress)?"text-amber-300":"text-emerald-300",children:(null==t?void 0:t.scanInProgress)?"Scan in progress":"Ready"})]}),(0,s.jsxs)("span",{children:["Queue: ",null!==(e=null==t?void 0:t.queueLength)&&void 0!==e?e:0]})]})]})]}),(0,s.jsxs)(c.Zb,{className:"border border-slate-800/80 bg-slate-950/80",children:[(0,s.jsx)(c.Ol,{className:"border-b border-slate-800/80 pb-3",children:(0,s.jsx)(c.ll,{className:"text-sm text-slate-100",children:"Recent Scan Jobs"})}),(0,s.jsx)(c.aY,{className:"pt-3",children:0===f.length?(0,s.jsx)("p",{className:"py-6 text-center text-slate-400 text-sm",children:"No scan jobs yet. Run a scan to get started."}):(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-slate-800 text-xs",children:[(0,s.jsx)("thead",{className:"bg-slate-950/60 text-[11px] uppercase tracking-[0.16em] text-slate-400",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-4 py-2 text-left",children:"Type"}),(0,s.jsx)("th",{className:"px-4 py-2 text-left",children:"Status"}),(0,s.jsx)("th",{className:"px-4 py-2 text-left",children:"Resources"}),(0,s.jsx)("th",{className:"px-4 py-2 text-left",children:"Findings"}),(0,s.jsx)("th",{className:"px-4 py-2 text-left",children:"Completed"})]})}),(0,s.jsx)("tbody",{className:"divide-y divide-slate-800/80",children:f.map(e=>(0,s.jsxs)("tr",{className:"hover:bg-slate-900/70",children:[(0,s.jsx)("td",{className:"px-4 py-2 text-slate-200",children:e.type}),(0,s.jsx)("td",{className:"px-4 py-2",children:(0,s.jsx)("span",{className:"completed"===e.status?"text-emerald-300":"failed"===e.status?"text-red-300":"text-amber-300",children:e.status})}),(0,s.jsx)("td",{className:"px-4 py-2 text-slate-300",children:e.resourceCount}),(0,s.jsx)("td",{className:"px-4 py-2 text-slate-300",children:e.findingCount}),(0,s.jsx)("td",{className:"px-4 py-2 text-slate-400",children:e.completedAt?new Date(e.completedAt).toLocaleString():"â€”"})]},e.id))})]})})})]})]})}},23611:function(e,t,n){"use strict";n.d(t,{z:function(){return d}});var s=n(57437),a=n(2265),c=n(74972),l=n(39213),i=n(81628);let o=(0,l.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-60",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-sm hover:bg-primary/90",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",outline:"border border-border bg-background hover:bg-accent hover:text-accent-foreground",ghost:"hover:bg-accent hover:text-accent-foreground text-muted-foreground",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",subtle:"bg-muted text-muted-foreground hover:bg-muted/80 border border-transparent"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-6",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),d=a.forwardRef((e,t)=>{let{className:n,variant:a,size:l,asChild:d=!1,...u}=e,f=d?c.g7:"button";return(0,s.jsx)(f,{className:(0,i.cn)(o({variant:a,size:l,className:n})),ref:t,...u})});d.displayName="Button"},49598:function(e,t,n){"use strict";n.d(t,{Ol:function(){return CardHeader},Zb:function(){return Card},aY:function(){return CardContent},ll:function(){return CardTitle}});var s=n(57437);n(2265);var a=n(81628);function Card(e){let{className:t,...n}=e;return(0,s.jsx)("div",{className:(0,a.cn)("rounded-xl border border-border bg-card text-card-foreground shadow-soft/60",t),...n})}function CardHeader(e){let{className:t,...n}=e;return(0,s.jsx)("div",{className:(0,a.cn)("flex flex-col space-y-1.5 border-b border-border/60 px-6 py-4",t),...n})}function CardTitle(e){let{className:t,...n}=e;return(0,s.jsx)("h3",{className:(0,a.cn)("text-base font-semibold leading-tight",t),...n})}function CardContent(e){let{className:t,...n}=e;return(0,s.jsx)("div",{className:(0,a.cn)("px-6 py-5",t),...n})}},81628:function(e,t,n){"use strict";n.d(t,{cn:function(){return cn}});var s=n(57042),a=n(74769);function cn(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,a.m6)((0,s.W)(t))}},88062:function(e,t,n){"use strict";n.d(t,{$c:function(){return getRules},AW:function(){return getComplianceScore},CP:function(){return getCategories},Cn:function(){return getRiskTrend},IQ:function(){return getFrameworkFindings},PA:function(){return getFrameworks},PF:function(){return updateFindingStatus},Qe:function(){return getScannerStatus},TN:function(){return getDashboardMetrics},Vh:function(){return getAssets},_M:function(){return getFindings},ku:function(){return getScanJobs},lZ:function(){return triggerScan},pC:function(){return getCategoryFindings},r5:function(){return getFindingsBySeverity},tY:function(){return getFrameworkScores}});var s=n(92173),a=n(62601);let c=s.Z.create({baseURL:a.env.NEXT_PUBLIC_API_BASE_URL||"http://localhost:8080/api"});async function getScannerStatus(){let{data:e}=await c.get("/scanner/status");return e}async function triggerScan(){let{data:e}=await c.post("/scanner/scan");return e}async function getFindings(e){let{data:t}=await c.get("/scanner/findings",{params:e});return t}async function updateFindingStatus(e,t){await c.post("/scanner/findings/".concat(e,"/status"),{status:t})}async function getDashboardMetrics(){let{data:e}=await c.get("/dashboard/metrics");return e}async function getComplianceScore(){let{data:e}=await c.get("/dashboard/compliance-score");return e}async function getFindingsBySeverity(){let{data:e}=await c.get("/dashboard/findings-by-severity");return e}async function getFrameworkScores(){let{data:e}=await c.get("/dashboard/framework-scores");return e}async function getRiskTrend(){let{data:e}=await c.get("/dashboard/risk-trend");return e}async function getScanJobs(e){let{data:t}=await c.get("/scanner/jobs",{params:e?{limit:e}:void 0});return t}async function getRules(){let{data:e}=await c.get("/rules");return e}async function getFrameworks(){let{data:e}=await c.get("/compliance/frameworks");return e}async function getFrameworkFindings(e,t){let{data:n}=await c.get("/compliance/frameworks/".concat(e,"/findings"),{params:t});return n}async function getCategories(){let{data:e}=await c.get("/compliance/categories");return e}async function getCategoryFindings(e,t){let{data:n}=await c.get("/compliance/categories/".concat(e,"/findings"),{params:t});return n}async function getAssets(e){let{data:t}=await c.get("/assets",{params:e});return t}},74972:function(e,t,n){"use strict";function _extends(){return(_extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e}).apply(null,arguments)}n.d(t,{g7:function(){return a}});var s=n(2265);function $6ed0406888f73fc4$var$setRef(e,t){"function"==typeof e?e(t):null!=e&&(e.current=t)}function $6ed0406888f73fc4$export$43e446d32b3d21af(...e){return t=>e.forEach(e=>$6ed0406888f73fc4$var$setRef(e,t))}let a=(0,s.forwardRef)((e,t)=>{let{children:n,...a}=e,l=s.Children.toArray(n),i=l.find($5e63c961fc1ce211$var$isSlottable);if(i){let e=i.props.children,n=l.map(t=>t!==i?t:s.Children.count(e)>1?s.Children.only(null):(0,s.isValidElement)(e)?e.props.children:null);return(0,s.createElement)(c,_extends({},a,{ref:t}),(0,s.isValidElement)(e)?(0,s.cloneElement)(e,void 0,n):null)}return(0,s.createElement)(c,_extends({},a,{ref:t}),n)});a.displayName="Slot";let c=(0,s.forwardRef)((e,t)=>{let{children:n,...a}=e;return(0,s.isValidElement)(n)?(0,s.cloneElement)(n,{...$5e63c961fc1ce211$var$mergeProps(a,n.props),ref:t?$6ed0406888f73fc4$export$43e446d32b3d21af(t,n.ref):n.ref}):s.Children.count(n)>1?s.Children.only(null):null});c.displayName="SlotClone";let $5e63c961fc1ce211$export$d9f1ccf0bdb05d45=({children:e})=>(0,s.createElement)(s.Fragment,null,e);function $5e63c961fc1ce211$var$isSlottable(e){return(0,s.isValidElement)(e)&&e.type===$5e63c961fc1ce211$export$d9f1ccf0bdb05d45}function $5e63c961fc1ce211$var$mergeProps(e,t){let n={...t};for(let s in t){let a=e[s],c=t[s],l=/^on[A-Z]/.test(s);l?a&&c?n[s]=(...e)=>{c(...e),a(...e)}:a&&(n[s]=a):"style"===s?n[s]={...a,...c}:"className"===s&&(n[s]=[a,c].filter(Boolean).join(" "))}return{...e,...n}}},39213:function(e,t,n){"use strict";function r(e){var t,n,s="";if("string"==typeof e||"number"==typeof e)s+=e;else if("object"==typeof e){if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=r(e[t]))&&(s&&(s+=" "),s+=n);else for(t in e)e[t]&&(s&&(s+=" "),s+=t)}return s}function clsx(){for(var e,t,n=0,s="";n<arguments.length;)(e=arguments[n++])&&(t=r(e))&&(s&&(s+=" "),s+=t);return s}n.d(t,{j:function(){return cva}});let falsyToString=e=>"boolean"==typeof e?"".concat(e):0===e?"0":e,s=clsx,cva=(e,t)=>n=>{var a;if((null==t?void 0:t.variants)==null)return s(e,null==n?void 0:n.class,null==n?void 0:n.className);let{variants:c,defaultVariants:l}=t,i=Object.keys(c).map(e=>{let t=null==n?void 0:n[e],s=null==l?void 0:l[e];if(null===t)return null;let a=falsyToString(t)||falsyToString(s);return c[e][a]}),o=n&&Object.entries(n).reduce((e,t)=>{let[n,s]=t;return void 0===s||(e[n]=s),e},{}),d=null==t?void 0:null===(a=t.compoundVariants)||void 0===a?void 0:a.reduce((e,t)=>{let{class:n,className:s,...a}=t;return Object.entries(a).every(e=>{let[t,n]=e;return Array.isArray(n)?n.includes({...l,...o}[t]):({...l,...o})[t]===n})?[...e,n,s]:e},[]);return s(e,i,d,null==n?void 0:n.class,null==n?void 0:n.className)}}},function(e){e.O(0,[895,384,971,472,744],function(){return e(e.s=84936)}),_N_E=e.O()}]);
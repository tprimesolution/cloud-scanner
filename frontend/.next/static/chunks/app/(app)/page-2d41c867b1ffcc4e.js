(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[198],{62501:function(e,t,s){Promise.resolve().then(s.bind(s,96344))},96344:function(e,t,s){"use strict";s.r(t),s.d(t,{DashboardClient:function(){return DashboardClient}});var a=s(57437),r=s(2265),n=s(64280),l=s(23611),i=s(49598),o=s(81628);function Skeleton(e){let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,o.cn)("animate-pulse rounded-md bg-muted/60",t),...s})}var c=s(84123),d=s(45253),u=s(57703),x=s(28485);function ComplianceScoreCard(e){let{score:t,loading:s,lastEvaluated:r,resourceCount:n}=e,l=Math.max(0,Math.min(t,100));return(0,a.jsxs)(i.Zb,{className:"h-full bg-gradient-to-br from-slate-950 via-slate-950/80 to-slate-900/80 border-slate-800 shadow-soft",children:[(0,a.jsxs)(i.Ol,{className:"flex flex-row items-center justify-between border-b border-slate-800/80 pb-3",children:[(0,a.jsxs)(i.ll,{className:"flex items-center gap-2 text-sm text-slate-100",children:[(0,a.jsx)(c.Z,{className:"h-4 w-4 text-sky-300"}),"Overall Compliance"]}),(0,a.jsx)("span",{className:(0,o.cn)("text-[11px] font-medium",l>=90?"text-emerald-400":l>=75?"text-sky-300":"text-amber-300"),children:l>=90?"Excellent":l>=75?"Healthy":"At risk"})]}),(0,a.jsx)(i.aY,{className:"flex items-center gap-4 pt-5",children:s?(0,a.jsxs)("div",{className:"flex flex-1 items-center gap-4",children:[(0,a.jsx)(Skeleton,{className:"h-24 w-24 rounded-full"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(Skeleton,{className:"h-5 w-16"}),(0,a.jsx)(Skeleton,{className:"h-3 w-24"}),(0,a.jsx)(Skeleton,{className:"h-3 w-32"})]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"h-28 w-28",children:(0,a.jsx)(d.h,{children:(0,a.jsx)(u.u,{children:(0,a.jsx)(x.b,{data:[{name:"Compliant",value:l},{name:"Gap",value:100-l}],dataKey:"value",innerRadius:34,outerRadius:54,startAngle:90,endAngle:-270,stroke:"none",cornerRadius:8})})})}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{className:"text-3xl font-semibold text-slate-50",children:[l.toFixed(0),"%"]}),(0,a.jsx)("p",{className:"text-xs text-slate-400",children:"Benchmarked against CIS AWS, ISO 27001, and SOC 2 controls."}),(0,a.jsxs)("p",{className:"text-[11px] text-slate-500",children:["Last evaluated"," ",(0,a.jsx)("span",{className:"text-slate-300",children:r?new Date(r).toLocaleString():"Never"})," ","across"," ",(0,a.jsxs)("span",{className:"text-slate-300",children:[null!=n?n:0," resources"]}),"."]})]})]})})]})}var m=s(62574),f=s(4631),h=s(49036),g=s(23157);let b={neutral:"bg-slate-900/80 border-slate-800/80",risk:"bg-amber-950/60 border-amber-500/20",positive:"bg-emerald-950/40 border-emerald-500/25"};function SummaryMetrics(e){var t,s,r,n;let{metrics:l,loading:c}=e,d=[{label:"Total Assets",value:c?"—":String(null!==(t=null==l?void 0:l.totalAssets)&&void 0!==t?t:0),delta:void 0,icon:m.Z,tone:"neutral"},{label:"Active Violations",value:c?"—":String(null!==(s=null==l?void 0:l.activeViolations)&&void 0!==s?s:0),delta:void 0,icon:f.Z,tone:"risk"},{label:"Critical Risks",value:c?"—":String(null!==(r=null==l?void 0:l.criticalRisks)&&void 0!==r?r:0),delta:void 0,icon:h.Z,tone:"risk"},{label:"Framework Coverage",value:c?"—":null!==(n=null==l?void 0:l.frameworkCoverage)&&void 0!==n?n:"0%",delta:"CIS, ISO, SOC2",icon:g.Z,tone:"positive"}];return(0,a.jsx)("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2 xl:grid-cols-4",children:d.map(e=>{let t=e.icon;return(0,a.jsx)(i.Zb,{className:(0,o.cn)("h-full border px-4 py-3 shadow-soft/40 backdrop-blur-sm",b[e.tone]),children:(0,a.jsxs)(i.aY,{className:"flex items-center justify-between space-x-3 px-0 py-0",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("p",{className:"text-[11px] font-medium uppercase tracking-[0.18em] text-slate-400",children:e.label}),(0,a.jsx)("p",{className:"text-xl font-semibold text-slate-50",children:e.value}),e.delta&&(0,a.jsx)("p",{className:"text-[11px] text-slate-400",children:e.delta})]}),(0,a.jsx)("div",{className:"flex h-9 w-9 items-center justify-center rounded-xl bg-slate-900/80 text-sky-300 shadow-soft/40",children:(0,a.jsx)(t,{className:"h-4 w-4"})})]})},e.label)})})}var p=s(36612);let v=[{name:"Critical",value:0,color:"#f97373"},{name:"High",value:0,color:"#fb923c"},{name:"Medium",value:0,color:"#eab308"},{name:"Low",value:0,color:"#22c55e"}];function ViolationsSeverityChart(e){let{data:t,loading:s}=e,r=(null==t?void 0:t.length)?t:v;return(0,a.jsxs)(i.Zb,{className:"h-full border border-slate-800/80 bg-slate-950/80 shadow-soft/40",children:[(0,a.jsx)(i.Ol,{className:"border-b border-slate-800/80 pb-3",children:(0,a.jsx)(i.ll,{className:"text-sm text-slate-100",children:"Violations by Severity"})}),(0,a.jsx)(i.aY,{className:"flex h-64 items-center justify-between gap-4 pt-4",children:s?(0,a.jsx)("div",{className:"flex h-full w-full items-center justify-center text-slate-400 text-sm",children:"Loading..."}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"h-full flex-1",children:(0,a.jsx)(d.h,{children:(0,a.jsx)(u.u,{children:(0,a.jsx)(x.b,{data:r,dataKey:"value",nameKey:"name",innerRadius:48,outerRadius:72,paddingAngle:3,cornerRadius:6,children:r.map(e=>(0,a.jsx)(p.b,{fill:e.color,stroke:"none"},e.name))})})})}),(0,a.jsx)("div",{className:"w-32 space-y-2 text-[11px] text-slate-300",children:r.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,a.jsx)("span",{className:"h-2.5 w-2.5 rounded-full",style:{backgroundColor:e.color}}),(0,a.jsx)("span",{children:e.name})]}),(0,a.jsx)("span",{className:"text-slate-400",children:e.value})]},e.name))})]})})]})}var j=s(44909),y=s(16573),N=s(24235),w=s(50039),k=s(86812),S=s(31346);let C=[{name:"CIS AWS",score:0},{name:"ISO 27001",score:0},{name:"SOC 2",score:0}];function FrameworkComplianceChart(e){let{data:t,loading:s}=e,r=(null==t?void 0:t.length)?t:C;return(0,a.jsxs)(i.Zb,{className:"h-full border border-slate-800/80 bg-slate-950/80 shadow-soft/40",children:[(0,a.jsx)(i.Ol,{className:"border-b border-slate-800/80 pb-3",children:(0,a.jsx)(i.ll,{className:"text-sm text-slate-100",children:"Compliance by Framework"})}),(0,a.jsx)(i.aY,{className:"h-64 pt-4",children:s?(0,a.jsx)("div",{className:"flex h-full items-center justify-center text-slate-400 text-sm",children:"Loading..."}):(0,a.jsx)(d.h,{children:(0,a.jsxs)(j.v,{data:r,barSize:28,children:[(0,a.jsx)(y.q,{strokeDasharray:"3 3",stroke:"#1e293b",vertical:!1}),(0,a.jsx)(N.K,{dataKey:"name",tickLine:!1,axisLine:!1,tick:{fill:"#9ca3af",fontSize:11}}),(0,a.jsx)(w.B,{tickLine:!1,axisLine:!1,tick:{fill:"#6b7280",fontSize:10},tickFormatter:e=>"".concat(e,"%"),domain:[0,100]}),(0,a.jsx)(k.u,{contentStyle:{background:"#020617",border:"1px solid #1e293b",fontSize:11},labelStyle:{color:"#e5e7eb"}}),(0,a.jsx)(S.$,{dataKey:"score",radius:[6,6,0,0],fill:"url(#frameworkGradient)"}),(0,a.jsx)("defs",{children:(0,a.jsxs)("linearGradient",{id:"frameworkGradient",x1:"0",y1:"0",x2:"1",y2:"1",children:[(0,a.jsx)("stop",{offset:"0%",stopColor:"#38bdf8"}),(0,a.jsx)("stop",{offset:"100%",stopColor:"#6366f1"})]})})]})})})]})}var F=s(38227),R=s(19223);function RiskTrendChart(e){let{data:t,loading:s}=e,r=(null==t?void 0:t.length)?t:[];return(0,a.jsxs)(i.Zb,{className:"h-full border border-slate-800/80 bg-slate-950/80 shadow-soft/40",children:[(0,a.jsx)(i.Ol,{className:"border-b border-slate-800/80 pb-3",children:(0,a.jsx)(i.ll,{className:"text-sm text-slate-100",children:"Risk & Compliance Trend"})}),(0,a.jsx)(i.aY,{className:"h-64 pt-4",children:s?(0,a.jsx)("div",{className:"flex h-full items-center justify-center text-slate-400 text-sm",children:"Loading..."}):0===r.length?(0,a.jsx)("div",{className:"flex h-full items-center justify-center text-slate-400 text-sm",children:"No scan history yet. Run scans to see trend."}):(0,a.jsx)(d.h,{children:(0,a.jsxs)(F.w,{data:r,children:[(0,a.jsx)(y.q,{strokeDasharray:"3 3",stroke:"#1e293b",vertical:!1}),(0,a.jsx)(N.K,{dataKey:"week",tickLine:!1,axisLine:!1,tick:{fill:"#9ca3af",fontSize:11}}),(0,a.jsx)(w.B,{tickLine:!1,axisLine:!1,tick:{fill:"#6b7280",fontSize:10},domain:[60,100],tickFormatter:e=>"".concat(e,"%")}),(0,a.jsx)(k.u,{contentStyle:{background:"#020617",border:"1px solid #1e293b",fontSize:11},labelStyle:{color:"#e5e7eb"}}),(0,a.jsx)(R.x,{type:"monotone",dataKey:"score",stroke:"#38bdf8",strokeWidth:2,dot:{r:3,strokeWidth:1,stroke:"#0f172a",fill:"#38bdf8"},activeDot:{r:4}})]})})})]})}var L=s(61396),A=s.n(L);function SeverityPill(e){var t;let{value:s}=e,r=s.charAt(0).toUpperCase()+s.slice(1).toLowerCase(),n={critical:"bg-red-500/15 text-red-300 border border-red-500/40",high:"bg-orange-500/15 text-orange-300 border border-orange-500/40",medium:"bg-amber-500/15 text-amber-300 border border-amber-500/40",low:"bg-emerald-500/15 text-emerald-300 border border-emerald-500/40",informational:"bg-slate-500/15 text-slate-300 border border-slate-500/40"},l=null!==(t=n[s.toLowerCase()])&&void 0!==t?t:n.medium;return(0,a.jsx)("span",{className:(0,o.cn)("inline-flex items-center rounded-full px-2 py-0.5 text-[11px] font-medium",l),children:r})}function formatTimeAgo(e){let t=new Date(e),s=new Date,a=Math.floor((s.getTime()-t.getTime())/1e3);return a<60?"just now":a<3600?"".concat(Math.floor(a/60)," min ago"):a<86400?"".concat(Math.floor(a/3600)," hr ago"):"".concat(Math.floor(a/86400)," days ago")}function RecentFindingsTable(e){let{findings:t,total:s,onRefresh:r}=e,n=null!=t?t:[];return(0,a.jsxs)(i.Zb,{className:"h-full border border-slate-800/80 bg-slate-950/80 shadow-soft/40",children:[(0,a.jsxs)(i.Ol,{className:"flex flex-row items-center justify-between border-b border-slate-800/80 pb-3",children:[(0,a.jsx)(i.ll,{className:"text-sm text-slate-100",children:"Recent Findings"}),(0,a.jsx)(A(),{href:"/findings",children:(0,a.jsx)(l.z,{variant:"ghost",size:"sm",className:"text-[11px] text-sky-300 hover:text-sky-200",children:"View all"})})]}),(0,a.jsx)(i.aY,{className:"pt-3",children:(0,a.jsx)("div",{className:"overflow-hidden rounded-lg border border-slate-800/80",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-slate-800 text-xs",children:[(0,a.jsx)("thead",{className:"bg-slate-950/60 text-[11px] uppercase tracking-[0.16em] text-slate-400",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-4 py-2 text-left font-medium",children:"Resource"}),(0,a.jsx)("th",{className:"px-4 py-2 text-left font-medium",children:"Issue"}),(0,a.jsx)("th",{className:"px-4 py-2 text-left font-medium",children:"Severity"}),(0,a.jsx)("th",{className:"px-4 py-2 text-left font-medium",children:"Framework"}),(0,a.jsx)("th",{className:"px-4 py-2 text-left font-medium",children:"Last detected"}),(0,a.jsx)("th",{className:"px-4 py-2 text-right font-medium",children:"Action"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-slate-800/80 bg-slate-950/40",children:0===n.length?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:6,className:"px-4 py-8 text-center text-slate-400 text-sm",children:"No findings yet. Run a scan to discover issues."})}):n.map((e,t)=>{var s,r,n,l;return(0,a.jsxs)("tr",{className:(0,o.cn)("hover:bg-slate-900/70",t%2==1&&"bg-slate-950/60"),children:[(0,a.jsx)("td",{className:"max-w-[160px] truncate px-4 py-2 text-[11px] text-slate-100",children:e.resourceId}),(0,a.jsx)("td",{className:"px-4 py-2 text-[11px] text-slate-200",children:e.message}),(0,a.jsx)("td",{className:"px-4 py-2",children:(0,a.jsx)(SeverityPill,{value:e.severity})}),(0,a.jsx)("td",{className:"px-4 py-2 text-[11px] text-slate-300",children:null!==(n=null===(s=e.controlIds)||void 0===s?void 0:s[0])&&void 0!==n?n:"—"}),(0,a.jsx)("td",{className:"px-4 py-2 text-[11px] text-slate-400",children:formatTimeAgo(e.lastSeenAt)}),(0,a.jsx)("td",{className:"px-4 py-2 text-right",children:(0,a.jsx)("span",{className:"text-[11px] text-sky-300",children:null!==(l=null===(r=e.rule)||void 0===r?void 0:r.name)&&void 0!==l?l:"See rule"})})]},e.id)})})]})})})]})}var T=s(88062);function DashboardClient(){var e,t;let[s,i]=(0,r.useState)(!0),[o,c]=(0,r.useState)(null),[d,u]=(0,r.useState)(null),[x,m]=(0,r.useState)(null),[f,h]=(0,r.useState)([]),[g,b]=(0,r.useState)([]),[p,v]=(0,r.useState)({items:[],total:0}),[j,y]=(0,r.useState)([]),refresh=async()=>{i(!0);try{c(null);let[e,t,s,a,r,n]=await Promise.all([(0,T.TN)(),(0,T.AW)(),(0,T.r5)(),(0,T.tY)(),(0,T._M)({limit:10,offset:0}),(0,T.Cn)()]);u(e),m(t),h(s),b(a),v(r),y(n)}catch(e){c(e instanceof Error?e.message:"Failed to load dashboard")}finally{i(!1)}};return((0,r.useEffect)(()=>{refresh();let onScanComplete=()=>refresh();return window.addEventListener("scan-complete",onScanComplete),()=>window.removeEventListener("scan-complete",onScanComplete)},[]),s&&!d)?(0,a.jsx)("div",{className:"flex min-h-[400px] items-center justify-center",children:(0,a.jsx)("div",{className:"text-sm text-slate-400",children:"Loading dashboard..."})}):o&&!d?(0,a.jsx)("div",{className:"rounded-lg border border-amber-500/30 bg-amber-950/20 p-4 text-sm text-amber-200",children:o}):(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsxs)(l.z,{variant:"ghost",size:"sm",onClick:refresh,disabled:s,className:"text-[11px] text-slate-400 hover:text-slate-200",children:[(0,a.jsx)(n.Z,{className:"mr-1.5 h-3.5 w-3.5"}),"Refresh"]})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-[minmax(0,1.4fr)_minmax(0,1.2fr)]",children:[(0,a.jsx)(ComplianceScoreCard,{score:null!==(e=null==x?void 0:x.score)&&void 0!==e?e:100,loading:s,lastEvaluated:null==x?void 0:x.lastEvaluated,resourceCount:null!==(t=null==x?void 0:x.resourceCount)&&void 0!==t?t:0}),(0,a.jsx)(SummaryMetrics,{metrics:d,loading:s})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-[minmax(0,1.2fr)_minmax(0,1.2fr)]",children:[(0,a.jsx)(ViolationsSeverityChart,{data:f,loading:s}),(0,a.jsx)(FrameworkComplianceChart,{data:g,loading:s})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-[minmax(0,1.3fr)_minmax(0,1.1fr)]",children:[(0,a.jsx)(RecentFindingsTable,{findings:p.items,total:p.total,onRefresh:refresh}),(0,a.jsx)(RiskTrendChart,{data:j,loading:s})]})]})}},23611:function(e,t,s){"use strict";s.d(t,{z:function(){return c}});var a=s(57437),r=s(2265),n=s(74972),l=s(39213),i=s(81628);let o=(0,l.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-60",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-sm hover:bg-primary/90",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",outline:"border border-border bg-background hover:bg-accent hover:text-accent-foreground",ghost:"hover:bg-accent hover:text-accent-foreground text-muted-foreground",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",subtle:"bg-muted text-muted-foreground hover:bg-muted/80 border border-transparent"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-6",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),c=r.forwardRef((e,t)=>{let{className:s,variant:r,size:l,asChild:c=!1,...d}=e,u=c?n.g7:"button";return(0,a.jsx)(u,{className:(0,i.cn)(o({variant:r,size:l,className:s})),ref:t,...d})});c.displayName="Button"},49598:function(e,t,s){"use strict";s.d(t,{Ol:function(){return CardHeader},Zb:function(){return Card},aY:function(){return CardContent},ll:function(){return CardTitle}});var a=s(57437);s(2265);var r=s(81628);function Card(e){let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,r.cn)("rounded-xl border border-border bg-card text-card-foreground shadow-soft/60",t),...s})}function CardHeader(e){let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,r.cn)("flex flex-col space-y-1.5 border-b border-border/60 px-6 py-4",t),...s})}function CardTitle(e){let{className:t,...s}=e;return(0,a.jsx)("h3",{className:(0,r.cn)("text-base font-semibold leading-tight",t),...s})}function CardContent(e){let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,r.cn)("px-6 py-5",t),...s})}},81628:function(e,t,s){"use strict";s.d(t,{cn:function(){return cn}});var a=s(57042),r=s(74769);function cn(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,r.m6)((0,a.W)(t))}},88062:function(e,t,s){"use strict";s.d(t,{$c:function(){return getRules},AW:function(){return getComplianceScore},CP:function(){return getCategories},Cn:function(){return getRiskTrend},IQ:function(){return getFrameworkFindings},PA:function(){return getFrameworks},PF:function(){return updateFindingStatus},Qe:function(){return getScannerStatus},TN:function(){return getDashboardMetrics},Vh:function(){return getAssets},_M:function(){return getFindings},ku:function(){return getScanJobs},lZ:function(){return triggerScan},pC:function(){return getCategoryFindings},r5:function(){return getFindingsBySeverity},tY:function(){return getFrameworkScores}});var a=s(92173),r=s(62601);let n=a.Z.create({baseURL:r.env.NEXT_PUBLIC_API_BASE_URL||"http://localhost:8080/api"});async function getScannerStatus(){let{data:e}=await n.get("/scanner/status");return e}async function triggerScan(){let{data:e}=await n.post("/scanner/scan");return e}async function getFindings(e){let{data:t}=await n.get("/scanner/findings",{params:e});return t}async function updateFindingStatus(e,t){await n.post("/scanner/findings/".concat(e,"/status"),{status:t})}async function getDashboardMetrics(){let{data:e}=await n.get("/dashboard/metrics");return e}async function getComplianceScore(){let{data:e}=await n.get("/dashboard/compliance-score");return e}async function getFindingsBySeverity(){let{data:e}=await n.get("/dashboard/findings-by-severity");return e}async function getFrameworkScores(){let{data:e}=await n.get("/dashboard/framework-scores");return e}async function getRiskTrend(){let{data:e}=await n.get("/dashboard/risk-trend");return e}async function getScanJobs(e){let{data:t}=await n.get("/scanner/jobs",{params:e?{limit:e}:void 0});return t}async function getRules(){let{data:e}=await n.get("/rules");return e}async function getFrameworks(){let{data:e}=await n.get("/compliance/frameworks");return e}async function getFrameworkFindings(e,t){let{data:s}=await n.get("/compliance/frameworks/".concat(e,"/findings"),{params:t});return s}async function getCategories(){let{data:e}=await n.get("/compliance/categories");return e}async function getCategoryFindings(e,t){let{data:s}=await n.get("/compliance/categories/".concat(e,"/findings"),{params:t});return s}async function getAssets(e){let{data:t}=await n.get("/assets",{params:e});return t}}},function(e){e.O(0,[895,384,382,368,971,472,744],function(){return e(e.s=62501)}),_N_E=e.O()}]);
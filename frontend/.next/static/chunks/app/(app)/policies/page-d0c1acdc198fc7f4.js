(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[508],{94859:function(e,t,n){Promise.resolve().then(n.bind(n,346))},346:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return PoliciesPage}});var r=n(57437),a=n(2265),s=n(49598),c=n(88062),i=n(81628);function PoliciesPage(){let[e,t]=(0,a.useState)([]),[n,o]=(0,a.useState)(!0);(0,a.useEffect)(()=>{(0,c.$c)().then(t).catch(console.error).finally(()=>o(!1))},[]);let l={critical:"bg-red-500/15 text-red-300",high:"bg-orange-500/15 text-orange-300",medium:"bg-amber-500/15 text-amber-300",low:"bg-emerald-500/15 text-emerald-300"};return(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-lg font-semibold tracking-tight text-slate-50",children:"Policies"}),(0,r.jsx)("p",{className:"text-xs text-slate-400",children:"Compliance rules evaluated during scans."})]}),(0,r.jsxs)(s.Zb,{className:"border border-slate-800/80 bg-slate-950/80",children:[(0,r.jsx)(s.Ol,{className:"border-b border-slate-800/80 pb-3",children:(0,r.jsx)(s.ll,{className:"text-sm text-slate-100",children:"Active Rules"})}),(0,r.jsx)(s.aY,{className:"pt-3",children:n?(0,r.jsx)("p",{className:"py-6 text-center text-slate-400",children:"Loading..."}):0===e.length?(0,r.jsx)("p",{className:"py-6 text-center text-slate-400",children:"No rules yet. Run a scan to auto-create rules from plugins."}):(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-slate-800 text-xs",children:[(0,r.jsx)("thead",{className:"bg-slate-950/60 text-[11px] uppercase tracking-[0.16em] text-slate-400",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-4 py-2 text-left",children:"Code"}),(0,r.jsx)("th",{className:"px-4 py-2 text-left",children:"Name"}),(0,r.jsx)("th",{className:"px-4 py-2 text-left",children:"Resource Type"}),(0,r.jsx)("th",{className:"px-4 py-2 text-left",children:"Severity"}),(0,r.jsx)("th",{className:"px-4 py-2 text-left",children:"Controls"})]})}),(0,r.jsx)("tbody",{className:"divide-y divide-slate-800/80",children:e.map(e=>{var t,n,a;return(0,r.jsxs)("tr",{className:"hover:bg-slate-900/70",children:[(0,r.jsx)("td",{className:"px-4 py-2 font-mono text-sky-300",children:e.code}),(0,r.jsx)("td",{className:"px-4 py-2 text-slate-200",children:e.name}),(0,r.jsx)("td",{className:"px-4 py-2 text-slate-300",children:e.resourceType}),(0,r.jsx)("td",{className:"px-4 py-2",children:(0,r.jsx)("span",{className:(0,i.cn)("rounded-full px-2 py-0.5 text-[11px]",null!==(n=l[e.severity])&&void 0!==n?n:"bg-slate-500/15"),children:e.severity})}),(0,r.jsx)("td",{className:"px-4 py-2 text-slate-400",children:null!==(a=null===(t=e.controlIds)||void 0===t?void 0:t.join(", "))&&void 0!==a?a:"â€”"})]},e.id)})})]})})})]})]})}},49598:function(e,t,n){"use strict";n.d(t,{Ol:function(){return CardHeader},Zb:function(){return Card},aY:function(){return CardContent},ll:function(){return CardTitle}});var r=n(57437);n(2265);var a=n(81628);function Card(e){let{className:t,...n}=e;return(0,r.jsx)("div",{className:(0,a.cn)("rounded-xl border border-border bg-card text-card-foreground shadow-soft/60",t),...n})}function CardHeader(e){let{className:t,...n}=e;return(0,r.jsx)("div",{className:(0,a.cn)("flex flex-col space-y-1.5 border-b border-border/60 px-6 py-4",t),...n})}function CardTitle(e){let{className:t,...n}=e;return(0,r.jsx)("h3",{className:(0,a.cn)("text-base font-semibold leading-tight",t),...n})}function CardContent(e){let{className:t,...n}=e;return(0,r.jsx)("div",{className:(0,a.cn)("px-6 py-5",t),...n})}},81628:function(e,t,n){"use strict";n.d(t,{cn:function(){return cn}});var r=n(57042),a=n(74769);function cn(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,a.m6)((0,r.W)(t))}},88062:function(e,t,n){"use strict";n.d(t,{$c:function(){return getRules},AW:function(){return getComplianceScore},CP:function(){return getCategories},Cn:function(){return getRiskTrend},Cr:function(){return getControlChecks},Hj:function(){return getFrameworkCriteria},IQ:function(){return getFrameworkFindings},MF:function(){return getEnterpriseFrameworks},PA:function(){return getFrameworks},PF:function(){return updateFindingStatus},Qe:function(){return getScannerStatus},TN:function(){return getDashboardMetrics},Tg:function(){return updateCriteriaScope},Vh:function(){return getAssets},_M:function(){return getFindings},ku:function(){return getScanJobs},lZ:function(){return triggerScan},pC:function(){return getCategoryFindings},qu:function(){return getFrameworkSummary},r5:function(){return getFindingsBySeverity},tY:function(){return getFrameworkScores},vO:function(){return getCriteriaControls}});var r=n(92173),a=n(62601);let s=r.Z.create({baseURL:a.env.NEXT_PUBLIC_API_BASE_URL||"http://localhost:8080/api"});async function getScannerStatus(){let{data:e}=await s.get("/scanner/status");return e}async function triggerScan(){let{data:e}=await s.post("/scanner/scan");return e}async function getFindings(e){let{data:t}=await s.get("/scanner/findings",{params:e});return t}async function updateFindingStatus(e,t){await s.post("/scanner/findings/".concat(e,"/status"),{status:t})}async function getDashboardMetrics(){let{data:e}=await s.get("/dashboard/metrics");return e}async function getComplianceScore(){let{data:e}=await s.get("/dashboard/compliance-score");return e}async function getFindingsBySeverity(){let{data:e}=await s.get("/dashboard/findings-by-severity");return e}async function getFrameworkScores(){let{data:e}=await s.get("/dashboard/framework-scores");return e}async function getRiskTrend(){let{data:e}=await s.get("/dashboard/risk-trend");return e}async function getScanJobs(e){let{data:t}=await s.get("/scanner/jobs",{params:e?{limit:e}:void 0});return t}async function getRules(){let{data:e}=await s.get("/rules");return e}async function getFrameworks(){let{data:e}=await s.get("/compliance/frameworks");return e}async function getFrameworkFindings(e,t){let{data:n}=await s.get("/compliance/frameworks/".concat(e,"/findings"),{params:t});return n}async function getEnterpriseFrameworks(){let{data:e}=await s.get("/frameworks");return e}async function getFrameworkSummary(e){let{data:t}=await s.get("/frameworks/".concat(e,"/summary"));return t}async function getFrameworkCriteria(e){let{data:t}=await s.get("/frameworks/".concat(e,"/criteria"));return t}async function updateCriteriaScope(e,t){let{data:n}=await s.post("/criteria/".concat(e,"/scope"),{scope:t});return n}async function getCriteriaControls(e){let{data:t}=await s.get("/criteria/".concat(e,"/controls"));return t}async function getControlChecks(e){let{data:t}=await s.get("/controls/".concat(e,"/checks"));return t}async function getCategories(){let{data:e}=await s.get("/compliance/categories");return e}async function getCategoryFindings(e,t){let{data:n}=await s.get("/compliance/categories/".concat(e,"/findings"),{params:t});return n}async function getAssets(e){let{data:t}=await s.get("/assets",{params:e});return t}}},function(e){e.O(0,[895,384,971,472,744],function(){return e(e.s=94859)}),_N_E=e.O()}]);
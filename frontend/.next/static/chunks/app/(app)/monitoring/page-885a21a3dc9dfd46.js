(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[567],{69354:function(e,t,n){Promise.resolve().then(n.bind(n,49929))},49929:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return MonitoringPage}});var r=n(57437),s=n(2265),a=n(61396),c=n.n(a),i=n(49598),o=n(23611),l=n(88062);function MonitoringPage(){var e;let[t,n]=(0,s.useState)(null),[a,u]=(0,s.useState)([]),[d,g]=(0,s.useState)(!0);return(0,s.useEffect)(()=>{let refresh=async()=>{try{let[e,t]=await Promise.all([(0,l.Qe)(),(0,l.ku)(5)]);n(e),u(t)}catch(e){console.error(e)}finally{g(!1)}};refresh();let e=setInterval(refresh,1e4);return()=>clearInterval(e)},[]),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-lg font-semibold tracking-tight text-slate-50",children:"Monitoring"}),(0,r.jsx)("p",{className:"text-xs text-slate-400",children:"Scan status and recent activity. Scheduler runs daily full scans and hourly incremental scans when enabled."})]}),(0,r.jsxs)(i.Zb,{className:"border border-slate-800/80 bg-slate-950/80",children:[(0,r.jsx)(i.Ol,{className:"border-b border-slate-800/80 pb-3",children:(0,r.jsx)(i.ll,{className:"text-sm text-slate-100",children:"Scanner Status"})}),(0,r.jsx)(i.aY,{className:"pt-4",children:d?(0,r.jsx)("p",{className:"text-slate-400",children:"Loading..."}):(0,r.jsxs)("div",{className:"flex gap-4 text-sm",children:[(0,r.jsxs)("span",{children:["Status:"," ",(0,r.jsx)("span",{className:(null==t?void 0:t.scanInProgress)?"text-amber-300":"text-emerald-300",children:(null==t?void 0:t.scanInProgress)?"Scan in progress":"Ready"})]}),(0,r.jsxs)("span",{children:["Queue: ",null!==(e=null==t?void 0:t.queueLength)&&void 0!==e?e:0]})]})})]}),(0,r.jsxs)(i.Zb,{className:"border border-slate-800/80 bg-slate-950/80",children:[(0,r.jsx)(i.Ol,{className:"border-b border-slate-800/80 pb-3",children:(0,r.jsx)(i.ll,{className:"text-sm text-slate-100",children:"Recent Scans"})}),(0,r.jsx)(i.aY,{className:"pt-3",children:d?(0,r.jsx)("p",{className:"text-slate-400",children:"Loading..."}):0===a.length?(0,r.jsx)("p",{className:"text-slate-400",children:"No scans yet."}):(0,r.jsx)("ul",{className:"space-y-2",children:a.map(e=>(0,r.jsxs)("li",{className:"flex items-center justify-between text-sm",children:[(0,r.jsx)("span",{className:"text-slate-300",children:e.type}),(0,r.jsx)("span",{className:"completed"===e.status?"text-emerald-300":"failed"===e.status?"text-red-300":"text-amber-300",children:e.status}),(0,r.jsx)("span",{className:"text-slate-400 text-[11px]",children:e.completedAt?new Date(e.completedAt).toLocaleString():"â€”"})]},e.id))})})]}),(0,r.jsx)(c(),{href:"/scanner",children:(0,r.jsx)(o.z,{variant:"outline",size:"sm",children:"Go to Scanner"})})]})}},23611:function(e,t,n){"use strict";n.d(t,{z:function(){return l}});var r=n(57437),s=n(2265),a=n(74972),c=n(39213),i=n(81628);let o=(0,c.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-60",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-sm hover:bg-primary/90",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",outline:"border border-border bg-background hover:bg-accent hover:text-accent-foreground",ghost:"hover:bg-accent hover:text-accent-foreground text-muted-foreground",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",subtle:"bg-muted text-muted-foreground hover:bg-muted/80 border border-transparent"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-6",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),l=s.forwardRef((e,t)=>{let{className:n,variant:s,size:c,asChild:l=!1,...u}=e,d=l?a.g7:"button";return(0,r.jsx)(d,{className:(0,i.cn)(o({variant:s,size:c,className:n})),ref:t,...u})});l.displayName="Button"},49598:function(e,t,n){"use strict";n.d(t,{Ol:function(){return CardHeader},Zb:function(){return Card},aY:function(){return CardContent},ll:function(){return CardTitle}});var r=n(57437);n(2265);var s=n(81628);function Card(e){let{className:t,...n}=e;return(0,r.jsx)("div",{className:(0,s.cn)("rounded-xl border border-border bg-card text-card-foreground shadow-soft/60",t),...n})}function CardHeader(e){let{className:t,...n}=e;return(0,r.jsx)("div",{className:(0,s.cn)("flex flex-col space-y-1.5 border-b border-border/60 px-6 py-4",t),...n})}function CardTitle(e){let{className:t,...n}=e;return(0,r.jsx)("h3",{className:(0,s.cn)("text-base font-semibold leading-tight",t),...n})}function CardContent(e){let{className:t,...n}=e;return(0,r.jsx)("div",{className:(0,s.cn)("px-6 py-5",t),...n})}},81628:function(e,t,n){"use strict";n.d(t,{cn:function(){return cn}});var r=n(57042),s=n(74769);function cn(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,s.m6)((0,r.W)(t))}},88062:function(e,t,n){"use strict";n.d(t,{$c:function(){return getRules},AW:function(){return getComplianceScore},CP:function(){return getCategories},Cn:function(){return getRiskTrend},IQ:function(){return getFrameworkFindings},PA:function(){return getFrameworks},PF:function(){return updateFindingStatus},Qe:function(){return getScannerStatus},TN:function(){return getDashboardMetrics},Vh:function(){return getAssets},_M:function(){return getFindings},ku:function(){return getScanJobs},lZ:function(){return triggerScan},pC:function(){return getCategoryFindings},r5:function(){return getFindingsBySeverity},tY:function(){return getFrameworkScores}});var r=n(92173),s=n(62601);let a=r.Z.create({baseURL:s.env.NEXT_PUBLIC_API_BASE_URL||"http://localhost:8080/api"});async function getScannerStatus(){let{data:e}=await a.get("/scanner/status");return e}async function triggerScan(){let{data:e}=await a.post("/scanner/scan");return e}async function getFindings(e){let{data:t}=await a.get("/scanner/findings",{params:e});return t}async function updateFindingStatus(e,t){await a.post("/scanner/findings/".concat(e,"/status"),{status:t})}async function getDashboardMetrics(){let{data:e}=await a.get("/dashboard/metrics");return e}async function getComplianceScore(){let{data:e}=await a.get("/dashboard/compliance-score");return e}async function getFindingsBySeverity(){let{data:e}=await a.get("/dashboard/findings-by-severity");return e}async function getFrameworkScores(){let{data:e}=await a.get("/dashboard/framework-scores");return e}async function getRiskTrend(){let{data:e}=await a.get("/dashboard/risk-trend");return e}async function getScanJobs(e){let{data:t}=await a.get("/scanner/jobs",{params:e?{limit:e}:void 0});return t}async function getRules(){let{data:e}=await a.get("/rules");return e}async function getFrameworks(){let{data:e}=await a.get("/compliance/frameworks");return e}async function getFrameworkFindings(e,t){let{data:n}=await a.get("/compliance/frameworks/".concat(e,"/findings"),{params:t});return n}async function getCategories(){let{data:e}=await a.get("/compliance/categories");return e}async function getCategoryFindings(e,t){let{data:n}=await a.get("/compliance/categories/".concat(e,"/findings"),{params:t});return n}async function getAssets(e){let{data:t}=await a.get("/assets",{params:e});return t}}},function(e){e.O(0,[895,384,382,971,472,744],function(){return e(e.s=69354)}),_N_E=e.O()}]);